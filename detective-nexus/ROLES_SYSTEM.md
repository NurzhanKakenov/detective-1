# Система ролей и прав доступа Detective Nexus

## Иерархия званий

1. **Детектив** (`detective`) - базовый уровень
2. **Старший детектив** (`senior_detective`) - повышенные права
3. **Лейтенант** (`lieutenant`) - руководящая должность
4. **Капитан** (`captain`) - старший руководитель
5. **Майор** (`major`) - высшее руководство
6. **Администратор** (`admin`) - полные права системы

## Права доступа по званиям

### Детектив
- ✅ Просмотр и создание дел
- ✅ Работа с уликами
- ✅ Просмотр собственного профиля
- ❌ Создание отчетов
- ❌ Редактирование профилей
- ❌ Управление детективами
- ❌ Просмотр отчетов других

### Старший детектив и выше
- ✅ Все права детектива
- ✅ **Создание отчетов**
- ✅ **Редактирование профилей**
- ✅ **Просмотр всех отчетов департамента**

### Лейтенант и выше
- ✅ Все права старшего детектива
- ✅ **Управление детективами** (добавление новых)
- ✅ Назначение дел

### Капитан и выше
- ✅ Все права лейтенанта
- ✅ **Доступ к админ панели**
- ✅ Управление департаментом

### Майор и Администратор
- ✅ Полные права системы
- ✅ Управление всеми пользователями
- ✅ Системные настройки

## Функциональность отчетов

### Создание отчетов
- **Кто может создавать**: Старший детектив и выше
- **Типы отчетов**:
  - Месячный отчет
  - Недельный отчет
  - Сводка по делам
  - Отчет по эффективности

### Просмотр отчетов
- **Кто может просматривать**: Старший детектив и выше
- **Что отображается**:
  - Все отчеты, созданные в департаменте
  - Информация о создателе отчета
  - Статистика по делам
  - Возможность скачивания

### Уведомления о отчетах
При создании отчета:
1. Создатель получает подтверждение
2. Все старшие детективы и руководители получают уведомление о новом отчете
3. Отчет становится доступен для просмотра всем с соответствующими правами

## Редактирование профилей

### Права редактирования
- **Кто может редактировать**: Старший детектив и выше
- **Что можно редактировать**:
  - Полное имя
  - Звание (только ниже своего)
  - Отдел
  - Номер значка

### Ограничения
- Нельзя назначить звание выше своего
- Детективы могут только просматривать профили
- Изменения логируются в системе

## Интерфейс

### Индикаторы прав доступа
- **Дашборд**: Карточка с текущими правами пользователя
- **Профиль**: Секция "Права доступа" с детализацией
- **Кнопки**: Отключены с подсказками о требуемом звании

### Уведомления об ограничениях
При попытке выполнить действие без прав:
- Показывается уведомление с объяснением
- Указывается требуемое звание
- Предлагаются альтернативные действия

## Техническая реализация

### Файлы системы ролей
- `types/index.ts` - Определения типов и иерархии
- `lib/permissions.ts` - Логика проверки прав
- `hooks/useCurrentUser.ts` - Хук для получения текущего пользователя
- `components/ReportsSection.tsx` - Компонент отчетов с проверкой прав

### Проверка прав
```typescript
const permissions = getUserPermissions(user)
if (permissions.canCreateReports) {
  // Разрешить создание отчета
}
```

### Условное отображение
```typescript
{permissions.canEditProfiles && (
  <EditButton />
)}
```

## Безопасность

- Все проверки прав выполняются как на фронтенде, так и на бэкенде
- Пользователи видят только те функции, к которым имеют доступ
- Попытки обхода ограничений логируются
- Система ролей легко расширяется для новых функций